C51 COMPILER V9.56.0.0   ____                                                              07/08/2017 13:39:20 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE ____
OBJECT MODULE PLACED IN 接收.OBJ
COMPILER INVOKED BY: C:\Program Files (x86)\Keil_C51\C51\BIN\C51.EXE 接收.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND 
                    -TABS(2)

line level    source

   1          
   2          #include "nRF24L01.h" 
   3            
   4          uchar TX_ADDRESS[TX_ADR_WIDTH]={0xB1,0x51,0xF3,0x08,0x70}; //发送地址   //更改收发地址
   5          uchar RX_ADDRESS[RX_ADR_WIDTH]={0xB2,0x52,0xF4,0x09,0x71}; //接收地址
   6          
   7          uchar   rate = 0x0F;    //2Mbs, 0dB  低噪声增益开启
   8          
   9          
  10          sbit    LED1      =P3^2;        //信号灯接口  根据自己焊接决定
  11          sbit    LED2      =P3^3;        
  12          sbit  LED3    =P3^4;
  13          sbit  L1      =P2^0;          //电机控制接口
  14          sbit  L2      =P2^1;
  15          sbit  R1      =P2^2;
  16          sbit  R2      =P2^3;
  17          sbit    action2   =P2^6;
  18          sbit    action    =P2^7;        //风扇控制接口
  19          uchar rece_buf[32];             //接收寄存器
  20                        //a0=37:最大角度，脉宽1.899ms
  21          
  22          uchar temp_time = 0;
  23          sbit pwm_out = P0^0;
  24          sbit pwm_out_part1 = P0^1;
  25          sbit pwm_out_part2 = P0^2;
  26          uchar set_speed = 0;
  27          
  28          void delay(uint t)
  29          {
  30   1        uint a,b;
  31   1        for(a=0;a<t;a++)
  32   1          for (b=0;b<255;b++);
  33   1      }
  34          
  35          void system_Init()
  36          {
  37   1        TMOD=0x01; 
  38   1        TH0=(65535 - 10) / 256; 
  39   1        TL0=(65535 - 10) % 256;
  40   1        TR0=1; 
  41   1        ET0=1; 
  42   1        EA=1; 
  43   1      }
  44          
  45          void main()
  46          { int i;
  47   1        uchar n=0,m=0;
  48   1        LED1=1;
  49   1        LED2=1;
  50   1        LED3=1;
  51   1        set_speed = 0;
  52   1        system_Init();
  53   1        while(NRF24L01_Check());                    //等待检测到NRF24L01，程序才会向下执行
  54   1        NRF24L01_RT_Init(TX_PLOAD_WIDTH,TX_ADDRESS,TX_ADR_WIDTH,RX_ADDRESS,RX_ADR_WIDTH,rate);      
C51 COMPILER V9.56.0.0   ____                                                              07/08/2017 13:39:20 PAGE 2   

  55   1      
  56   1        for(i=0;i<12;i++)
  57   1          {
  58   2            delay(100);   //自检成功
  59   2            LED1=~LED1;
  60   2          }
  61   1        LED1=1;
  62   1        pwm_out_part1 = 1;
  63   1        pwm_out_part2 = 0;
  64   1      
  65   1        while(1)
  66   1        {
  67   2          if(temp_time > 100)
  68   2          {
  69   3            temp_time = 0;    
  70   3          }
  71   2          if(NRF_IRQ==0)    // 如果无线模块接收到数据
  72   2          {   
  73   3            
  74   3            if(NRF24L01_RxPacket(rece_buf)==0)
  75   3            { 
  76   4              if(rece_buf[0]==1)
  77   4              {
  78   5                LED1=1;  
  79   5                LED2=0;
  80   5                LED3=1;
  81   5                set_speed = rece_buf[1];
  82   5              }
  83   4            } 
  84   3          }
  85   2          else  
  86   2          {                      //停止
  87   3                LED1=0;
  88   3                LED2=0;
  89   3                LED3=1;
  90   3      //          L1  =0;
  91   3      //          L2  =0;
  92   3      //          R1  =0;
  93   3      //          R2  =0;
  94   3      //          action2=0;
  95   3      //          action=0;
  96   3          }
  97   2          if(temp_time <= set_speed)
  98   2          pwm_out = 1;
  99   2          else pwm_out = 0;
 100   2      
 101   2      //**************************************    
 102   2        }
 103   1      }
 104          
 105          void timer0() interrupt 1 
 106          {
 107   1        TH0=(65535 - 10) / 256; 
 108   1        TL0=(65535 - 10) % 256;
 109   1        temp_time++;
 110   1        
 111   1      }
 112          
 113          
 114          


C51 COMPILER V9.56.0.0   ____                                                              07/08/2017 13:39:20 PAGE 3   

MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    692    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     45      35
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
